# 2주차

날짜: 2022년 11월 5일

## 제 4 장 - 결과를 전달하는 HTTP 상태 코드

- 상태 코드는 서버로부터 리퀘스트 결과를 전달한다
    - 클라이언트가 서버를 향해 리퀘스트를 보낼 때 서버에서 그 결과가 어떻게 되었는지 알려주는 것이 상태코드의 역할
    - 상태코드 클래스
        
        
        |  | 클래스 | 설명 |
        | --- | --- | --- |
        | 1xx | Informational | 리퀘스트를 받아들여 처리중 |
        | 2xx | Success | 리퀘스트를 정상적으로 처리했음 |
        | 3xx | Redirection | 리퀘스트를 완료하기 위해서 추가 동작이 필요 |
        | 4xx | Client Error | 서버는 리퀘스트 이해 불가능 |
        | 5xx | Server Error | 서버는 리퀘스트 처리 실패 |
    - 실제로 자주 사용되고 있는 것은 이 중에서 14종류 정도
- 2xx 성공 (Success)
2xx 리스폰스는 리퀘스트가 정상으로 처리되었음을 나타낸다.
    - 200 OK
    클라이언트가 보낸 리퀘스트를 서버가 정상 처리하였음을 나타낸다
    - 204 No Content
    서버가 리퀘스트를 받아서 처리하는 데는 성공했지만 리스폰스에 엔티티 바디를 포함하지 않는다.
    - 206 Partial Content
    Range에 의해서 범위가 지정된 리퀘스트에 의해서 서버가 부분적 GET 리퀘스트를 받았음을 나타낸다.
- 3xx 리다이렉트 (Redirection)
3xx 리스폰스는 리퀘스트가 정상적으로 처리를 종료하기 위해 브라우저 측에서 특별한 처리를 수행해야 함을 나타낸다.
    - 301 Moved Permanently
    리퀘스트된 리소스에는 새로운 URI가 부여되어 있기 때문에, 이후로는 그 리소스를 참조하는 URI를 사용해야 한다는 것을 나타낸다
    - 302 Found
    리퀘스트된 리소스에는 새로운 URI가 할당되어 있기 때문에, 그 URI를 참조해 주길 바란다는 의미를 나타낸다.
        - 301 Moved Permanently과 비슷하지만 영구적인 이동이 아닌, 어디까지난 일시적인 것
    - 303 See Other
    리퀘스트에 대한 리소스는 다른 URI에 있기 때문에 GET 메소드를 사용해서 얻어야 한다는 것을 나타낸다
        - 302 Found와 같은 기능이지만, 리다이렉트 장소를 GET 메소드로 얻어야 한다고 명확하게 되어있는 점이 다르다
    - 304 Not Modified
    클라이언트가 조건부 리퀘스트를 했을 때 리소스에 대한 액세스는 허락하지만,
    조건이 충족되지 않음을 표시한다.
    - 307 Temporary Redirect
    302 Found와 같은 의미를 지니지만, 302의 경우에는 POST로부터 GET으로 치환이 금지되어 있는데도 불구하고 구현상 그와 같이 되어 있지 않다.
        - 307에서는 브라우저 사양에 따라 POST에서 GET으로 치환하지 않는다.
- 4xx 클라이언트 에러 (Client Error)
4xx 리스폰스는 클라이언트의 원인으로 에러가 발생했음을 나타낸다
    - 400 Bad Request
    리퀘스트 구문이 잘못되었음을 나타낸다
        - 브라우저는 이것을 200 Ok와 같이 취급한다
    - 401 Unauthorized
    송신한 리퀘스트에 HTTP 인증(BASIC 인증, DIGEST 인증) 정보가 필요하다는 것을 나타낸다
    - 403 Forbidden
    리퀘스트된 리소스의 액세스가 거부되었음을 나타낸다
    - 404 Not Found
    리퀘스트한 리소스가 서버상에 없다는 것을 나타낸다
- 5xx 서버 에러 (Server Error)
5xx 리스폰스는 서버 원인으로 에러가 발생하고 있음을 나타낸다
    - 500 Internal Server Error
    서버에서 리퀘스트를 처리하는 도중에 에러가 발생하였음을 나타낸다
    - 502 Bad Gateway
    서버가 게이트웨이나 프록시 서버 역할을 하면서 업스트림 서버로부터 유효하지 않은 응답을 받았다는 것을 의미한다
    - 503 Service Unavailable
    일시적으로 서버가 과부하 상태이거나 점검중이기 때문에 현재 리퀘스트를 처리할 수 없음을 나타낸다.
- HTTP 상태 코드는 코드마다의 의미를 포함하고 있지만,
해당 의미에 엄청 얽매인다기보다는 클라이언트 및 서버의 합의에 의해 사용되는 것이 좋아보임
    - HTTP 요청의 성공/실패에 따라 상태코드가 정해져야 하는지,
    비즈니스 로직의 성공/실패에 따라 상태코드가 정해져야 하는지는 사내 합의를 통해 진행
    - 다만, 새로 참여하는 개발자들이 코드를 이해하기 쉽도록
    별개의 에러코드만 사용하는 것이 아닌 HTTP 상태코드로 API의 리스폰스를 추측케 하는것이 좋아보인다.

## 제 5 장 - HTTP와 연계하는 웹 서버

- 1대로 멀티 도메인을 가능하게 하는 가상 호스트
    - 가상 호스트 기능을 사용하면 물리적으로는 서버가 1대지만 가상으로 여러대가 있는 것처럼 설정이 가능하다
    - 같은 IP 주소에서 다른 호스트명과 도메인 명을 가진 여러 개의 웹 사이트가 실행되고 있는 가상 호스트의 시스템이 있기 때문에,
    HTTP 리퀘스트를 보내는 경우에는 호스트명과 도메인 명을 완전하게 포함한 URI를 지정하거나, 반드시 Host 헤더 필드를 지정해야 한다.
- 통신을 중계하는 프로그램 : 프록시, 게이트웨이, 터널
HTTP는 클라이언트와 서버 이외에 통신을 중계하는 프로그램과 서버를 연계하는 것도 가능하다
이러한 프로그램과 버서는 그 다음에 있는 다른 서버에 리퀘스트를 중계하고, 그 서버로부터 받은 리스폰스를 클라이언트에 반환하는 역할을 담당한다.
    - 프록시
    서버와 클라이언트의 양쪽 역할을 하는 중계 프로그램
        - 기본적인 동작은 클라이언트로부터 받은 리퀘스트를 다른 서버에 전송하는 것
        - 오리진 서버로부터 되돌아온 리스폰스는 프록시 서버를 경유해서 클라이언트에 돌아온다
        - 프록시 서버를 여러 대 경유하는 것도 가능하며, 중계할 때에는 Via 헤더 필드에 경유한 호스트 정보를 추가해야 한다.
        - 사용하는 이유
            - 캐시를 사용해서 네트워크 대역 등을 효율적으로 사용하는 것
            - 조직 내에 특정 웹 사이트에 대한 액세스 제한, 엑세스 로그를 획득하는 정책을 철저하게 지키려는 목적으로 사용하는 경우
        - 캐싱 프록시
            - 프록시로 리스폰스를 중계하는 때에는 프록시 서버 상에 리소스 캐시를 보존해두는 타입의 프록시
        - 투명 프록시
            - 리퀘스트와 리스폰스를 중계를 할 때 메시지 변경을 하지 않는 타입의 프록시
    - 게이트웨이
    다른서버를 중계하는 서버로, 클라이언트로부터 수신한 리퀘스트를 리소스를 보유한 서버인 것처럼 수신한다.
        - 그 다음에 있는 서버가 HTTP 서버 이외의 서비스를 제공하는 서버
        - 클라이언트와 게이트웨이 사이를 암호화하는 등으로 안전하게 접속함으로써 통신의 안전성을 높이는 역할
    - 터널
    서로 떨어진 두 대의 클라이언트와 서버 사이를 중계하며 접속을 주선하는 중계 프로그램
        - 요구에 따라서 다른 서버와의 통신 경로를 확립한다
        - 클라이언트는 SSL 같은 암호화 통신을 통해 서버와 안전하게 통신을 하기 위해 사용
- 리소스를 보관하는 캐시
    - 캐시는 프록시 서버와 클라이언트의 로컬 디스크에 보관된 리소스의 사본
    - 캐시를 사용하면 리소스를 가진 서버에의 액세스를 줄이는 것이 가능하기 때문에 통신량과 통신시간을 절약
    - 같은 데이터를 몇 번이고 오리진 서버에 전송할 필요가 없다는 것이 장점
    - 캐시를 가지고 있더라도 클라이언트의 요구나 캐시의 유효 기간 등에 의해서 오리진 서버에 리소스의 유효성을 확인하거나 새로운 리소스를 다시 획득하러 가게 되는 경우
    - 클라이언트가 사용하고 있는 브라우저에서도 캐시를 가질 수 있다